<!DOCTYPE html>
<html class="no-js" lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="../cdn-cgi/apps/head/1BY2f2zT8KygC6POfiT9T-bUTpY.js"></script><link rel="profile" href="https://gmpg.org/xfn/11">
<title>Spoofing URL previews &#8211; Raz</title>
<link rel='dns-prefetch' href='https://s0.wp.com/' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Raz &raquo; Feed" href="../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Raz &raquo; Comments Feed" href="../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Raz &raquo; Spoofing URL previews Comments Feed" href="feed/index.html" />

<link rel='stylesheet' id='crayon-css' href='../wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css%3Fver=_2.7.2_beta.css' media='all' />
<link rel='stylesheet' id='wp-block-library-css' href='../wp-includes/css/dist/block-library/style.min.css%3Fver=5.3.css' media='all' />
<link rel='stylesheet' id='font-awesome-5-css' href='../wp-content/plugins/themeisle-companion/obfx_modules/gutenberg-blocks/assets/fontawesome/css/all.min.css%3Fver=5.3.css' media='all' />
<link rel='stylesheet' id='font-awesome-4-shims-css' href='../wp-content/plugins/themeisle-companion/obfx_modules/gutenberg-blocks/assets/fontawesome/css/v4-shims.min.css%3Fver=5.3.css' media='all' />
<link rel='stylesheet' id='themeisle-block_styles-css' href='../wp-content/plugins/themeisle-companion/vendor/codeinwp/gutenberg-blocks/build/style.css%3Fver=5.3.css' media='all' />
<link rel='stylesheet' id='twentytwenty-style-css' href='../wp-content/themes/twentytwenty/style.css%3Fver=1.0.css' media='all' />
<style id='twentytwenty-style-inline-css'>
.color-accent,.color-accent-hover:hover,.color-accent-hover:focus,:root .has-accent-color,.has-drop-cap:not(:focus):first-letter,.wp-block-button.is-style-outline,a { color: #cd2653; }blockquote,.border-color-accent,.border-color-accent-hover:hover,.border-color-accent-hover:focus { border-color: #cd2653; }button:not(.toggle),.button,.faux-button,.wp-block-button__link,.wp-block-file .wp-block-file__button,input[type="button"],input[type="reset"],input[type="submit"],.bg-accent,.bg-accent-hover:hover,.bg-accent-hover:focus,:root .has-accent-background-color,.comment-reply-link { background-color: #cd2653; }.fill-children-accent,.fill-children-accent * { fill: #cd2653; }body,.entry-title a,:root .has-primary-color { color: #000000; }:root .has-primary-background-color { background-color: #000000; }cite,figcaption,.wp-caption-text,.post-meta,.entry-content .wp-block-archives li,.entry-content .wp-block-categories li,.entry-content .wp-block-latest-posts li,.wp-block-latest-comments__comment-date,.wp-block-latest-posts__post-date,.wp-block-embed figcaption,.wp-block-image figcaption,.wp-block-pullquote cite,.comment-metadata,.comment-respond .comment-notes,.comment-respond .logged-in-as,.pagination .dots,.entry-content hr:not(.has-background),hr.styled-separator,:root .has-secondary-color { color: #6d6d6d; }:root .has-secondary-background-color { background-color: #6d6d6d; }pre,fieldset,input,textarea,table,table *,hr { border-color: #dcd7ca; }caption,code,code,kbd,samp,.wp-block-table.is-style-stripes tbody tr:nth-child(odd),:root .has-subtle-background-background-color { background-color: #dcd7ca; }.wp-block-table.is-style-stripes { border-bottom-color: #dcd7ca; }.wp-block-latest-posts.is-grid li { border-top-color: #dcd7ca; }:root .has-subtle-background-color { color: #dcd7ca; }body:not(.overlay-header) .primary-menu > li > a,body:not(.overlay-header) .primary-menu > li > .icon,.modal-menu a,.footer-menu a, .footer-widgets a,#site-footer .wp-block-button.is-style-outline,.wp-block-pullquote:before,.singular:not(.overlay-header) .entry-header a,.archive-header a,.header-footer-group .color-accent,.header-footer-group .color-accent-hover:hover { color: #cd2653; }.social-icons a,#site-footer button:not(.toggle),#site-footer .button,#site-footer .faux-button,#site-footer .wp-block-button__link,#site-footer .wp-block-file__button,#site-footer input[type="button"],#site-footer input[type="reset"],#site-footer input[type="submit"] { background-color: #cd2653; }.header-footer-group,body:not(.overlay-header) #site-header .toggle,.menu-modal .toggle { color: #000000; }body:not(.overlay-header) .primary-menu ul { background-color: #000000; }body:not(.overlay-header) .primary-menu > li > ul:after { border-bottom-color: #000000; }body:not(.overlay-header) .primary-menu ul ul:after { border-left-color: #000000; }.site-description,body:not(.overlay-header) .toggle-inner .toggle-text,.widget .post-date,.widget .rss-date,.widget_archive li,.widget_categories li,.widget cite,.widget_pages li,.widget_meta li,.widget_nav_menu li,.powered-by-wordpress,.to-the-top,.singular .entry-header .post-meta,.singular:not(.overlay-header) .entry-header .post-meta a { color: #6d6d6d; }.header-footer-group pre,.header-footer-group fieldset,.header-footer-group input,.header-footer-group textarea,.header-footer-group table,.header-footer-group table *,.footer-nav-widgets-wrapper,#site-footer,.menu-modal nav *,.footer-widgets-outer-wrapper,.footer-top { border-color: #dcd7ca; }.header-footer-group table caption,body:not(.overlay-header) .header-inner .toggle-wrapper::before { background-color: #dcd7ca; }
</style>
<link rel='stylesheet' id='twentytwenty-print-style-css' href='../wp-content/themes/twentytwenty/print.css%3Fver=1.0.css' media='print' />
<link rel='stylesheet' id='twentytwenty-jetpack-css' href='../wp-content/plugins/jetpack/modules/theme-tools/compat/twentytwenty.css%3Fver=7.9.1.css' media='all' />
<link rel='stylesheet' id='jetpack_css-css' href='../wp-content/plugins/jetpack/css/jetpack.css%3Fver=7.9.1.css' media='all' />
<script src='../wp-includes/js/jquery/jquery.js%3Fver=1.12.4-wp' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script src='../wp-includes/js/jquery/jquery-migrate.min.js%3Fver=1.4.1' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script type="5a8293ed7e8e602563b9c36f-text/javascript">
var related_posts_js_options = {"post_heading":"h4"};
</script>
<script src='../wp-content/plugins/jetpack/_inc/build/related-posts/related-posts.min.js%3Fver=20191011' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script type="5a8293ed7e8e602563b9c36f-text/javascript">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/blog.razb.me\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src='../wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js%3Fver=_2.7.2_beta' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script src='../wp-content/themes/twentytwenty/assets/js/index.js%3Fver=1.0' async type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<link rel='https://api.w.org/' href='../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc.php%3Frsd" />
<link rel='prev' title='Pulling apart an iOS App' href='../pulling-apart-an-ios-app/index.html' />
<meta name="generator" content="WordPress 5.3" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='https://wp.me/p7krpY-5n' />
<link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fblog.razb.me%252Fspoofing-url-previews%252F" />
<link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fblog.razb.me%252Fspoofing-url-previews%252F&amp;format=xml" />

<link rel='dns-prefetch' href='https://v0.wordpress.com/' />
<link rel='dns-prefetch' href='https://i0.wp.com/' />
<link rel='dns-prefetch' href='https://i1.wp.com/' />
<link rel='dns-prefetch' href='https://i2.wp.com/' />
<style type='text/css'>img#wpstats{display:none}</style> <script type="5a8293ed7e8e602563b9c36f-text/javascript">document.documentElement.className = document.documentElement.className.replace( 'no-js', 'js' );</script>

<meta property="og:type" content="article" />
<meta property="og:title" content="Spoofing URL previews" />
<meta property="og:url" content="https://blog.razb.me/spoofing-url-previews/" />
<meta property="og:description" content="The rise of social media has enabled us to share content with one another at an unprecedented rate. From Facebook to Twitter to Reddit to iMessage we&#8217;re sharing things that we&#8217;ve found …" />
<meta property="article:published_time" content="2018-12-31T09:38:02+00:00" />
<meta property="article:modified_time" content="2019-01-13T01:25:31+00:00" />
<meta property="og:site_name" content="Raz" />
<meta property="og:image" content="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?fit=1000%2C1000&amp;ssl=1" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="1000" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Spoofing URL previews" />
<meta name="twitter:image" content="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?fit=1000%2C1000&#038;ssl=1&#038;w=640" />
<meta name="twitter:card" content="summary_large_image" />

<link rel="icon" href="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/04/cropped-Untitled.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/04/cropped-Untitled.png?fit=192%2C192&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/04/cropped-Untitled.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/04/cropped-Untitled.png?fit=270%2C270&#038;ssl=1" />

<script type="5a8293ed7e8e602563b9c36f-text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47022454-1', 'auto');
  ga('send', 'pageview');
</script>


</head>
<body class="post-template-default single single-post postid-333 single-format-standard singular enable-search-modal has-post-thumbnail has-single-pagination showing-comments show-avatars footer-top-visible">
<a class="skip-link screen-reader-text" href="index.html#site-content">Skip to the content</a>
<header id="site-header" class="header-footer-group" role="banner">
<div class="header-inner section-inner">
<div class="header-titles-wrapper">
<button class="toggle search-toggle mobile-search-toggle" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field" aria-expanded="false">
<span class="toggle-inner">
<span class="toggle-icon">
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23"><path d="M38.710696,48.0601792 L43,52.3494831 L41.3494831,54 L37.0601792,49.710696 C35.2632422,51.1481185 32.9839107,52.0076499 30.5038249,52.0076499 C24.7027226,52.0076499 20,47.3049272 20,41.5038249 C20,35.7027226 24.7027226,31 30.5038249,31 C36.3049272,31 41.0076499,35.7027226 41.0076499,41.5038249 C41.0076499,43.9839107 40.1481185,46.2632422 38.710696,48.0601792 Z M36.3875844,47.1716785 C37.8030221,45.7026647 38.6734666,43.7048964 38.6734666,41.5038249 C38.6734666,36.9918565 35.0157934,33.3341833 30.5038249,33.3341833 C25.9918565,33.3341833 22.3341833,36.9918565 22.3341833,41.5038249 C22.3341833,46.0157934 25.9918565,49.6734666 30.5038249,49.6734666 C32.7048964,49.6734666 34.7026647,48.8030221 36.1716785,47.3875844 C36.2023931,47.347638 36.2360451,47.3092237 36.2726343,47.2726343 C36.3092237,47.2360451 36.347638,47.2023931 36.3875844,47.1716785 Z" transform="translate(-20 -31)" /></svg> </span>
<span class="toggle-text">Search</span>
</span>
</button>
<div class="header-titles">
<div class="site-title faux-heading"><a href="../index.html">Raz</a></div><div class="site-description">Computer stuff</div>
</div>
<button class="toggle nav-toggle mobile-nav-toggle" data-toggle-target=".menu-modal" data-toggle-body-class="showing-menu-modal" aria-expanded="false" data-set-focus=".close-nav-toggle">
<span class="toggle-inner">
<span class="toggle-icon">
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="26" height="7" viewBox="0 0 26 7"><path fill-rule="evenodd" d="M332.5,45 C330.567003,45 329,43.4329966 329,41.5 C329,39.5670034 330.567003,38 332.5,38 C334.432997,38 336,39.5670034 336,41.5 C336,43.4329966 334.432997,45 332.5,45 Z M342,45 C340.067003,45 338.5,43.4329966 338.5,41.5 C338.5,39.5670034 340.067003,38 342,38 C343.932997,38 345.5,39.5670034 345.5,41.5 C345.5,43.4329966 343.932997,45 342,45 Z M351.5,45 C349.567003,45 348,43.4329966 348,41.5 C348,39.5670034 349.567003,38 351.5,38 C353.432997,38 355,39.5670034 355,41.5 C355,43.4329966 353.432997,45 351.5,45 Z" transform="translate(-329 -38)" /></svg> </span>
<span class="toggle-text">Menu</span>
</span>
</button>
</div>
<div class="header-navigation-wrapper">
<nav class="primary-menu-wrapper" aria-label="Horizontal" role="navigation">
<ul class="primary-menu reset-list-style">
<li id="menu-item-123" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-123"><a href="https://www.linkedin.com/in/razvan-bangu/">Linkedin</a></li>
</ul>
</nav>
<div class="header-toggles hide-no-js">
<div class="toggle-wrapper search-toggle-wrapper">
<button class="toggle search-toggle desktop-search-toggle" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field" aria-expanded="false">
<span class="toggle-inner">
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23"><path d="M38.710696,48.0601792 L43,52.3494831 L41.3494831,54 L37.0601792,49.710696 C35.2632422,51.1481185 32.9839107,52.0076499 30.5038249,52.0076499 C24.7027226,52.0076499 20,47.3049272 20,41.5038249 C20,35.7027226 24.7027226,31 30.5038249,31 C36.3049272,31 41.0076499,35.7027226 41.0076499,41.5038249 C41.0076499,43.9839107 40.1481185,46.2632422 38.710696,48.0601792 Z M36.3875844,47.1716785 C37.8030221,45.7026647 38.6734666,43.7048964 38.6734666,41.5038249 C38.6734666,36.9918565 35.0157934,33.3341833 30.5038249,33.3341833 C25.9918565,33.3341833 22.3341833,36.9918565 22.3341833,41.5038249 C22.3341833,46.0157934 25.9918565,49.6734666 30.5038249,49.6734666 C32.7048964,49.6734666 34.7026647,48.8030221 36.1716785,47.3875844 C36.2023931,47.347638 36.2360451,47.3092237 36.2726343,47.2726343 C36.3092237,47.2360451 36.347638,47.2023931 36.3875844,47.1716785 Z" transform="translate(-20 -31)" /></svg> <span class="toggle-text">Search</span>
</span>
</button>
</div>
</div>
</div>
</div>
<div class="search-modal cover-modal header-footer-group" data-modal-target-string=".search-modal">
<div class="search-modal-inner modal-inner">
<div class="section-inner">
<form role="search" aria-label="Search for:" method="get" class="search-form" action="../index.html">
<label for="search-form-1">
<span class="screen-reader-text">Search for:</span>
<input type="search" id="search-form-1" class="search-field" placeholder="Search &hellip;" value="" name="s" />
</label>
<input type="submit" class="search-submit" value="Search" />
</form>
<button class="toggle search-untoggle close-search-toggle fill-children-current-color" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field" aria-expanded="false">
<span class="screen-reader-text">Close search</span>
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><polygon fill="" fill-rule="evenodd" points="6.852 7.649 .399 1.195 1.445 .149 7.899 6.602 14.352 .149 15.399 1.195 8.945 7.649 15.399 14.102 14.352 15.149 7.899 8.695 1.445 15.149 .399 14.102" /></svg> </button>
</div>
</div>
</div>
</header>
<div class="menu-modal cover-modal header-footer-group" data-modal-target-string=".menu-modal">
<div class="menu-modal-inner modal-inner">
<div class="menu-wrapper section-inner">
<div class="menu-top">
<button class="toggle close-nav-toggle fill-children-current-color" data-toggle-target=".menu-modal" data-toggle-body-class="showing-menu-modal" aria-expanded="false" data-set-focus=".menu-modal">
<span class="toggle-text">Close Menu</span>
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><polygon fill="" fill-rule="evenodd" points="6.852 7.649 .399 1.195 1.445 .149 7.899 6.602 14.352 .149 15.399 1.195 8.945 7.649 15.399 14.102 14.352 15.149 7.899 8.695 1.445 15.149 .399 14.102" /></svg> </button>
<nav class="mobile-menu" aria-label="Mobile" role="navigation">
<ul class="modal-menu reset-list-style">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-123"><div class="ancestor-wrapper"><a href="https://www.linkedin.com/in/razvan-bangu/">Linkedin</a></div></li>
</ul>
</nav>
</div>
<div class="menu-bottom">
</div>
</div>
</div>
</div>
<main id="site-content" role="main">
<article class="post-333 post type-post status-publish format-standard has-post-thumbnail hentry category-social-media tag-facebook tag-imessage tag-phishing tag-reddit tag-social-media tag-spoofing tag-twitter" id="post-333">
<header class="entry-header has-text-align-center header-footer-group">
<div class="entry-header-inner section-inner medium">
<div class="entry-categories">
<span class="screen-reader-text">Categories</span>
<div class="entry-categories-inner">
<a href="../category/social-media/index.html" rel="category tag">Social Media</a> </div>
</div>
<h1 class="entry-title">Spoofing URL previews</h1>
<div class="post-meta-wrapper post-meta-single post-meta-single-top">
<ul class="post-meta">
<li class="post-author meta-wrapper">
<span class="meta-icon">
<span class="screen-reader-text">Post author</span>
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewBox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z" /></svg> </span>
<span class="meta-text">
By <a href="../author/raz/index.html">Raz</a> </span>
</li>
<li class="post-date meta-wrapper">
<span class="meta-icon">
<span class="screen-reader-text">Post date</span>
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewBox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z" /></svg> </span>
<span class="meta-text">
<a href="index.html">December 31, 2018</a>
</span>
</li>
<li class="post-comment-link meta-wrapper">
<span class="meta-icon">
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 19"><path d="M9.43016863,13.2235931 C9.58624731,13.094699 9.7823475,13.0241935 9.98476849,13.0241935 L15.0564516,13.0241935 C15.8581553,13.0241935 16.5080645,12.3742843 16.5080645,11.5725806 L16.5080645,3.44354839 C16.5080645,2.64184472 15.8581553,1.99193548 15.0564516,1.99193548 L3.44354839,1.99193548 C2.64184472,1.99193548 1.99193548,2.64184472 1.99193548,3.44354839 L1.99193548,11.5725806 C1.99193548,12.3742843 2.64184472,13.0241935 3.44354839,13.0241935 L5.76612903,13.0241935 C6.24715123,13.0241935 6.63709677,13.4141391 6.63709677,13.8951613 L6.63709677,15.5301903 L9.43016863,13.2235931 Z M3.44354839,14.766129 C1.67980032,14.766129 0.25,13.3363287 0.25,11.5725806 L0.25,3.44354839 C0.25,1.67980032 1.67980032,0.25 3.44354839,0.25 L15.0564516,0.25 C16.8201997,0.25 18.25,1.67980032 18.25,3.44354839 L18.25,11.5725806 C18.25,13.3363287 16.8201997,14.766129 15.0564516,14.766129 L10.2979143,14.766129 L6.32072889,18.0506004 C5.75274472,18.5196577 4.89516129,18.1156602 4.89516129,17.3790323 L4.89516129,14.766129 L3.44354839,14.766129 Z" /></svg> </span>
<span class="meta-text">
<a href="index.html#respond"><span class="dsq-postid" data-dsqidentifier="333 https://blog.razb.me/?p=333">No Comments<span class="screen-reader-text"> on Spoofing URL previews</span></span></a> </span>
</li>
</ul>
</div>
</div>
</header>
<figure class="featured-media">
<div class="featured-media-inner section-inner">
<img width="1000" height="1000" src="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?fit=1000%2C1000&amp;ssl=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" srcset="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?w=1000&amp;ssl=1 1000w, https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?resize=150%2C150&amp;ssl=1 150w, https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?resize=300%2C300&amp;ssl=1 300w, https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?resize=768%2C768&amp;ssl=1 768w, https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?resize=50%2C50&amp;ssl=1 50w" sizes="(max-width: 1000px) 100vw, 1000px" data-attachment-id="437" data-permalink="https://blog.razb.me/spoofing-url-previews/facebook_icon_2013-svg/" data-orig-file="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?fit=1000%2C1000&amp;ssl=1" data-orig-size="1000,1000" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Facebook_icon_2013.svg" data-image-description="" data-medium-file="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?fit=300%2C300&amp;ssl=1" data-large-file="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/Facebook_icon_2013.svg_.png?fit=580%2C580&amp;ssl=1" />
</div>
</figure>
<div class="post-inner thin ">
<div class="entry-content">
<p>The rise of social media has enabled us to share content with one another at an unprecedented rate. From Facebook to Twitter to Reddit to iMessage we&#8217;re sharing things that we&#8217;ve found on the internet more and more, so much so that it became difficult to decide what&#8217;s worth clicking on and what isn&#8217;t when we&#8217;re being presented with vast amounts of content summarized in the form of a URL. To solve this problem, URL previews were created.</p>
<hr class="wp-block-separator" />
<h4>So what is a URL preview?</h4>
<p>A URL preview is something which we&#8217;ve all seen while we browse the internet. Somebody shares a URL to some piece of content, usually a web page, and the social platform which we&#8217;re browsing automatically generates a preview of the content found at the URL. In the example Facebook post below, I am sharing a URL to one of my favourite games, RuneScape:</p>
<iframe src="https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Frazvan.mcbang%2Fposts%2F105811240495300&amp;width=500" width="500" height="491"></iframe>
<p>These previews are generally very helpful and provide us with rich context surrounding what sort of content we can expect to find if we were to actually click on the URL. In the example above, we get several pieces of information:</p>
<ul><li>A main picture which is supposed to depict what we might see when we click the link</li><li>The actual domain name which we can expect to find ourselves at when we click the link</li><li>A short textual description of what the web page is about</li></ul>
<p>Upon seeing the above post you might expect that clicking on the post will take you to <a href="http://runescape.com">runescape.com</a> and that the web page will look roughly as you expect it to look based on the preview provided by Facebook. However if you go ahead and actually click on the post above, you&#8217;ll find yourself at my proof-of-concept website instead: <a href="https://poc.razb.me">poc.razb.me</a></p>
<hr class="wp-block-separator" />
<h4>How are URL previews created?</h4>
<p>In order to understand how a URL preview might be spoofed, we must first understand how a URL preview is created. I will be using Facebook as my example platform, but all platforms which provide this sort of preview will function in a similar manner.</p>
<p>There are really only three main steps in generating a URL preview:</p>
<ol><li>Download a copy of the web page found at the URL</li><li>Inspect it for various metadata tags</li><li>Generate the preview</li></ol>
<p>The first step should be pretty straightforward, just make a GET request to the URL and save the resulting HTML.</p>
<p>The second step is specific to the platform. Each platform defines its own set of metadata tags which can be added to the HTML of any webpage for providing information to be used for populating URL previews. You can find out all about these HTML tags here: <a href="https://developers.facebook.com/docs/sharing/webmasters/">https://developers.facebook.com/docs/sharing/webmasters/</a></p>
<p>The third step is to put together the information provided via the metadata tags into a visual format which becomes the URL preview.</p>
<hr class="wp-block-separator" />
<h4>How can we spoof the preview generation?</h4>
<p>So far everything looks fine. I share a URL, Facebook fetches that web page and parses the HTML tags then generates the preview from them. How can we possibly spoof any of this? We don&#8217;t necessarily own the web page which we&#8217;re linking to, so what can we do?</p>
<p>Let&#8217;s try sharing a URL to a web page which we do own and check the GET request which Facebook makes.</p>
<p>Upon inspection, when Facebook makes a GET request to my proof-of-concept domain, the headers look something like this:</p>
<link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-d7f32d1731d95b9cb4d3c880c428c9e9.css">
<div id="gist93814398" class="gist">
<div class="gist-file">
<div class="gist-data">
<div class="js-gist-file-update-container js-task-list-container file-box">
<div id="file-facebook_header-json" class="file">
<div itemprop="text" class="blob-wrapper data type-json ">
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
<tbody><tr>
<td id="file-facebook_header-json-L1" class="blob-num js-line-number" data-line-number="1"></td>
<td id="file-facebook_header-json-LC1" class="blob-code blob-code-inner js-file-line">{</td>
</tr>
<tr>
<td id="file-facebook_header-json-L2" class="blob-num js-line-number" data-line-number="2"></td>
<td id="file-facebook_header-json-LC2" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>Host<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>poc.razb.me<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-facebook_header-json-L3" class="blob-num js-line-number" data-line-number="3"></td>
<td id="file-facebook_header-json-LC3" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>Connection<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>Keep-Alive<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-facebook_header-json-L4" class="blob-num js-line-number" data-line-number="4"></td>
<td id="file-facebook_header-json-LC4" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>Accept-Encoding<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>gzip<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-facebook_header-json-L5" class="blob-num js-line-number" data-line-number="5"></td>
<td id="file-facebook_header-json-LC5" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>Accept<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>*<span class="pl-cce">\\</span>/*<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-facebook_header-json-L6" class="blob-num js-line-number" data-line-number="6"></td>
<td id="file-facebook_header-json-LC6" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>User-Agent<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>facebookexternalhit<span class="pl-cce">\\</span>/1.1 (+http:<span class="pl-cce">\\</span>/<span class="pl-cce">\\</span>/<a class="vglnk" href="https://www.facebook.com" rel="nofollow"><span>www</span><span>.</span><span>facebook</span><span>.</span><span>com</span></a><span class="pl-cce">\\</span>/externalhit_uatext.php)<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-facebook_header-json-L7" class="blob-num js-line-number" data-line-number="7"></td>
<td id="file-facebook_header-json-LC7" class="blob-code blob-code-inner js-file-line">}</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="gist-meta">
<a href="https://gist.github.com/Raztor0/e57f5fd2fd26df06fc32d73894956ebf/raw/3456fd805c0e2f2dcb42e38315a6924170e97e84/facebook_header.json" style="float:right">view raw</a>
<a href="https://gist.github.com/Raztor0/e57f5fd2fd26df06fc32d73894956ebf#file-facebook_header-json">facebook_header.json</a>
hosted with <img draggable="false" class="emoji" alt="❤" src="https://s.w.org/images/core/emoji/11/svg/2764.svg" scale="0"> by <a href="https://github.com">GitHub</a>
</div>
</div>
</div>
<p>The field worth noting is the &#8220;User-Agent&#8221; field. This is used as a courtesy by the client requesting our web page and it lets us know what sort of browser (or in this case bot) was used to access our web page.</p>
<p>In the case of the Facebook URL preview generation, Facebook&#8217;s bot configured the &#8220;User-Agent&#8221; field to something specific to their use case and they call it &#8220;facebookexternalhit&#8221;.</p>
<p>For a normal user like you or I requesting my web page, the header will look something like this:</p>
<link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-d7f32d1731d95b9cb4d3c880c428c9e9.css">
<div id="gist93814446" class="gist">
<div class="gist-file">
<div class="gist-data">
<div class="js-gist-file-update-container js-task-list-container file-box">
<div id="file-normal_header-json" class="file">
<div itemprop="text" class="blob-wrapper data type-json ">
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
<tbody><tr>
<td id="file-normal_header-json-L1" class="blob-num js-line-number" data-line-number="1"></td>
<td id="file-normal_header-json-LC1" class="blob-code blob-code-inner js-file-line">{</td>
</tr>
<tr>
<td id="file-normal_header-json-L2" class="blob-num js-line-number" data-line-number="2"></td>
<td id="file-normal_header-json-LC2" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>Host<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>poc.razb.me<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-normal_header-json-L3" class="blob-num js-line-number" data-line-number="3"></td>
<td id="file-normal_header-json-LC3" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>Connection<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>Keep-Alive<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-normal_header-json-L4" class="blob-num js-line-number" data-line-number="4"></td>
<td id="file-normal_header-json-LC4" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>Accept-Encoding<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>gzip<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-normal_header-json-L5" class="blob-num js-line-number" data-line-number="5"></td>
<td id="file-normal_header-json-LC5" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">&#8220;</span>User-Agent<span class="pl-pds">&#8220;</span></span>: <span class="pl-s"><span class="pl-pds">&#8220;</span>Mozilla<span class="pl-cce">\\</span>/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit<span class="pl-cce">\\</span>/537.36 (KHTML, like Gecko) Chrome<span class="pl-cce">\\</span>/71.0.3578.98 Safari<span class="pl-cce">\\</span>/537.36<span class="pl-pds">&#8220;</span></span>,</td>
</tr>
<tr>
<td id="file-normal_header-json-L6" class="blob-num js-line-number" data-line-number="6"></td>
 <td id="file-normal_header-json-LC6" class="blob-code blob-code-inner js-file-line">}</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="gist-meta">
<a href="https://gist.github.com/Raztor0/206175807d0f9d4ab26dc1bac4ac7dc5/raw/d7e5cfaefd43bc7e1180c0113b68258508ea4add/normal_header.json" style="float:right">view raw</a>
<a href="https://gist.github.com/Raztor0/206175807d0f9d4ab26dc1bac4ac7dc5#file-normal_header-json">normal_header.json</a>
hosted with <img draggable="false" class="emoji" alt="❤" src="https://s.w.org/images/core/emoji/11/svg/2764.svg" scale="0"> by <a href="https://github.com">GitHub</a>
</div>
</div>
</div>
<p>In the normal case, the &#8220;User-Agent&#8221; field looks very different and actually contains information about the browser which I used to access my web page.</p>
<p>It turns out that we can use this subtle difference in User-Agent to serve Facebook&#8217;s bot a different response than we serve normal users.</p>
<hr class="wp-block-separator" />
<h4>User-Agent switching</h4>
<p>If for every request we read the User-Agent field before serving our web page, we can switch on the User-Agent value to serve different responses for bots and for regular users.</p>
<p>So what might we do differently for a bot so that it generates a preview for something other than our current web page? A simple solution is to simply return a 300 redirect to your target web page of choice.</p>
<p>Here is some sample code which can do just that in PHP:</p>
<link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-d7f32d1731d95b9cb4d3c880c428c9e9.css">
<div id="gist93814546" class="gist">
<div class="gist-file">
<div class="gist-data">
<div class="js-gist-file-update-container js-task-list-container file-box">
<div id="file-fb_bot_redirect-php" class="file">
<div itemprop="text" class="blob-wrapper data type-php ">
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
<tbody><tr>
<td id="file-fb_bot_redirect-php-L1" class="blob-num js-line-number" data-line-number="1"></td>
<td id="file-fb_bot_redirect-php-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L2" class="blob-num js-line-number" data-line-number="2"></td>
<td id="file-fb_bot_redirect-php-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-s1"></span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L3" class="blob-num js-line-number" data-line-number="3"></td>
<td id="file-fb_bot_redirect-php-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-s1"><span class="pl-smi">$user_agent</span> <span class="pl-k">=</span> <span class="pl-smi">$_SERVER</span>[<span class="pl-s"><span class="pl-pds">&#8220;</span>HTTP_USER_AGENT<span class="pl-pds">&#8220;</span></span>];</span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L4" class="blob-num js-line-number" data-line-number="4"></td>
<td id="file-fb_bot_redirect-php-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-s1"></span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L5" class="blob-num js-line-number" data-line-number="5"></td>
<td id="file-fb_bot_redirect-php-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-s1"><span class="pl-k">if</span> (<span class="pl-c1">strpos</span>(<span class="pl-smi">$user_agent</span>, <span class="pl-s"><span class="pl-pds">&#8220;</span>facebookexternalhit<span class="pl-pds">&#8220;</span></span>) <span class="pl-k">!</span><span class="pl-k">==</span> <span class="pl-c1">false</span>) {</span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L6" class="blob-num js-line-number" data-line-number="6"></td>
<td id="file-fb_bot_redirect-php-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-s1"> <span class="pl-c1">header</span>(<span class="pl-s"><span class="pl-pds">&#8220;</span>Location: <a class="vglnk" href="https://runescape.com" rel="nofollow"><span>https</span><span>://</span><span>runescape</span><span>.</span><span>com</span></a><span class="pl-pds">&#8220;</span></span>);</span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L7" class="blob-num js-line-number" data-line-number="7"></td>
<td id="file-fb_bot_redirect-php-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">} <span class="pl-k">else</span> {</span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L8" class="blob-num js-line-number" data-line-number="8"></td>
<td id="file-fb_bot_redirect-php-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-s1"> <span class="pl-c1">echo</span>(<span class="pl-s"><span class="pl-pds">&#8220;</span>poc.razb.me<span class="pl-pds">&#8220;</span></span>);</span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L9" class="blob-num js-line-number" data-line-number="9"></td>
<td id="file-fb_bot_redirect-php-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">}</span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L10" class="blob-num js-line-number" data-line-number="10"></td>
<td id="file-fb_bot_redirect-php-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-s1"></span></td>
</tr>
<tr>
<td id="file-fb_bot_redirect-php-L11" class="blob-num js-line-number" data-line-number="11"></td>
<td id="file-fb_bot_redirect-php-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="gist-meta">
<a href="https://gist.github.com/Raztor0/9573dcac3b76c446db9aa1a07760a0db/raw/26b6ce3e2ffe2f86c7ac2fd24eb6d3841c25fc82/fb_bot_redirect.php" style="float:right">view raw</a>
<a href="https://gist.github.com/Raztor0/9573dcac3b76c446db9aa1a07760a0db#file-fb_bot_redirect-php">fb_bot_redirect.php</a>
hosted with <img draggable="false" class="emoji" alt="❤" src="https://s.w.org/images/core/emoji/11/svg/2764.svg" scale="0"> by <a href="https://github.com">GitHub</a>
</div>
</div>
</div>
<p>In this example we simply set the &#8220;Location&#8221; header response to <a href="https://runescape.com">https://runescape.com</a>. This will tell Facebook&#8217;s bot to ignore whatever content it found at my URL poc.razb.me, and instead go looking at runescape.com. We can confirm that the bot is doing what we expect by using Facebook&#8217;s sharing debugger: <a href="https://developers.facebook.com/tools/debug/sharing/?q=https%3A%2F%2Fpoc.razb.me">https://developers.facebook.com/tools/debug/sharing/?q=https%3A%2F%2Fpoc.razb.me</a></p>
<p>It turns out this is all it takes to spoof the Facebook URL preview bot. It is also possible to perform the same simple switch on iMessage, Twitter, and Reddit previews. Here are some examples:</p>
<div class="wp-block-image"><figure class="alignleft"><img data-attachment-id="345" data-permalink="https://blog.razb.me/spoofing-url-previews/imessage_spoof/" data-orig-file="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/imessage_spoof.png?fit=618%2C456&amp;ssl=1" data-orig-size="618,456" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="imessage_spoof" data-image-description="" data-medium-file="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/imessage_spoof.png?fit=300%2C221&amp;ssl=1" data-large-file="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/imessage_spoof.png?fit=580%2C428&amp;ssl=1" src="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/imessage_spoof.png?w=580&#038;ssl=1" alt="" class="wp-image-345" srcset="https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/imessage_spoof.png?w=618&amp;ssl=1 618w, https://i2.wp.com/blog.razb.me/wp-content/uploads/2018/12/imessage_spoof.png?resize=300%2C221&amp;ssl=1 300w" sizes="(max-width: 580px) 100vw, 580px" data-recalc-dims="1" /><figcaption>iMessage preview spoof<br></figcaption></figure></div>
<figure class="wp-block-image"><img data-attachment-id="346" data-permalink="https://blog.razb.me/spoofing-url-previews/image/" data-orig-file="https://i1.wp.com/blog.razb.me/wp-content/uploads/2018/12/image.png?fit=936%2C166&amp;ssl=1" data-orig-size="936,166" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-medium-file="https://i1.wp.com/blog.razb.me/wp-content/uploads/2018/12/image.png?fit=300%2C53&amp;ssl=1" data-large-file="https://i1.wp.com/blog.razb.me/wp-content/uploads/2018/12/image.png?fit=580%2C103&amp;ssl=1" src="https://i1.wp.com/blog.razb.me/wp-content/uploads/2018/12/image.png?w=580&#038;ssl=1" alt="" class="wp-image-346" srcset="https://i1.wp.com/blog.razb.me/wp-content/uploads/2018/12/image.png?w=936&amp;ssl=1 936w, https://i1.wp.com/blog.razb.me/wp-content/uploads/2018/12/image.png?resize=300%2C53&amp;ssl=1 300w, https://i1.wp.com/blog.razb.me/wp-content/uploads/2018/12/image.png?resize=768%2C136&amp;ssl=1 768w" sizes="(max-width: 580px) 100vw, 580px" data-recalc-dims="1" /><figcaption>Reddit preview spoof</figcaption></figure>
<figure class="wp-block-image"><img data-attachment-id="463" data-permalink="https://blog.razb.me/spoofing-url-previews/spoof_tweet/" data-orig-file="https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?fit=1284%2C788&amp;ssl=1" data-orig-size="1284,788" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="spoof_tweet" data-image-description="" data-medium-file="https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?fit=300%2C184&amp;ssl=1" data-large-file="https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?fit=580%2C356&amp;ssl=1" src="https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?fit=750%2C460&amp;ssl=1" alt="" class="wp-image-463" srcset="https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?w=1284&amp;ssl=1 1284w, https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?resize=300%2C184&amp;ssl=1 300w, https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?resize=768%2C471&amp;ssl=1 768w, https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?resize=1024%2C628&amp;ssl=1 1024w, https://i0.wp.com/blog.razb.me/wp-content/uploads/2019/01/spoof_tweet.png?w=1160&amp;ssl=1 1160w" sizes="(max-width: 580px) 100vw, 580px" /><figcaption>Twitter preview spoof<br><a href="https://twitter.com/test_raz/status/1079640248743837696">https://twitter.com/test_raz/status/1079640248743837696</a></figcaption></figure>
<p>It&#8217;s important to note that both iMessage and Reddit actually preserve the original URL when generating the preview. This is a very good practise as it makes this sort of attack much less effective when the user can still see the original URL.</p>
<p>However, in the case of Facebook and Twitter they use the redirected URL in the preview and omit the original URL entirely. This makes it possible to trick somebody into thinking that they are about to go to one domain when in fact they will be taken to another.</p>
<hr class="wp-block-separator" />
<h4>Responsible Disclosure</h4>
<p>Prior to posting this blog post, I reached out to Facebook and Twitter (via their respective bug bounty programs <a href="https://www.facebook.com/whitehat">here</a> and <a href="https://hackerone.com/twitter">here</a>) and made sure that they are aware of the trick that I outlined in this post. They both got back to me and said that it is too low risk and they have no plans on changing the current behaviour.</p>
<p>So for the time being, pay extra close attention when clicking on content on Facebook and Twitter, and make sure the domain you end up at is the one you expected.</p>
<div id='jp-relatedposts' class='jp-relatedposts'>
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
</div>
</div>
<div class="section-inner">
<div class="post-meta-wrapper post-meta-single post-meta-single-bottom">
<ul class="post-meta">
<li class="post-tags meta-wrapper">
<span class="meta-icon">
<span class="screen-reader-text">Tags</span>
<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="" d="M15.4496399,8.42490555 L8.66109799,1.63636364 L1.63636364,1.63636364 L1.63636364,8.66081885 L8.42522727,15.44178 C8.57869221,15.5954158 8.78693789,15.6817418 9.00409091,15.6817418 C9.22124393,15.6817418 9.42948961,15.5954158 9.58327627,15.4414581 L15.4486339,9.57610048 C15.7651495,9.25692435 15.7649133,8.74206554 15.4496399,8.42490555 Z M16.6084423,10.7304545 L10.7406818,16.59822 C10.280287,17.0591273 9.65554997,17.3181054 9.00409091,17.3181054 C8.35263185,17.3181054 7.72789481,17.0591273 7.26815877,16.5988788 L0.239976954,9.57887876 C0.0863319284,9.4254126 0,9.21716044 0,9 L0,0.818181818 C0,0.366312477 0.366312477,0 0.818181818,0 L9,0 C9.21699531,0 9.42510306,0.0862010512 9.57854191,0.239639906 L16.6084423,7.26954545 C17.5601275,8.22691012 17.5601275,9.77308988 16.6084423,10.7304545 Z M5,6 C4.44771525,6 4,5.55228475 4,5 C4,4.44771525 4.44771525,4 5,4 C5.55228475,4 6,4.44771525 6,5 C6,5.55228475 5.55228475,6 5,6 Z" /></svg> </span>
<span class="meta-text">
<a href="../tag/facebook/index.html" rel="tag">facebook</a>, <a href="../tag/imessage/index.html" rel="tag">imessage</a>, <a href="../tag/phishing/index.html" rel="tag">phishing</a>, <a href="../tag/reddit/index.html" rel="tag">reddit</a>, <a href="../tag/social-media/index.html" rel="tag">social media</a>, <a href="../tag/spoofing/index.html" rel="tag">spoofing</a>, <a href="../tag/twitter/index.html" rel="tag">twitter</a> </span>
</li>
</ul>
</div>
<div class="author-bio">
<div class="author-title-wrapper">
<div class="author-avatar vcard">
<img alt='' src='https://secure.gravatar.com/avatar/aae6720c35ab12fac13db06788b2e7fb?s=160&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/aae6720c35ab12fac13db06788b2e7fb?s=320&#038;d=mm&#038;r=g 2x' class='avatar avatar-160 photo' height='160' width='160' /> </div>
<h2 class="author-title heading-size-4">
By Raz </h2>
</div>
<div class="author-description">
<p>I'm 25 years old and I do stuff with computers.</p>
<a class="author-link" href="../author/raz/index.html" rel="author">
View Archive <span aria-hidden="true">&rarr;</span> </a>
</div>
</div>
</div>
<nav class="pagination-single section-inner only-one only-prev" aria-label="Post" role="navigation">
<hr class="styled-separator is-style-wide" aria-hidden="true" />
<div class="pagination-single-inner">
<a class="previous-post" href="../pulling-apart-an-ios-app/index.html">
<span class="arrow" aria-hidden="true">&larr;</span>
<span class="title"><span class="title-inner">Pulling apart an iOS App</span></span>
</a>
</div>
<hr class="styled-separator is-style-wide" aria-hidden="true" />
</nav>
<div class="comments-wrapper section-inner">
<div id="disqus_thread"></div>
</div>
</article>
</main>
<div class="footer-nav-widgets-wrapper header-footer-group">
<div class="footer-inner section-inner">
<div class="footer-top has-footer-menu">
<nav aria-label="Footer" role="navigation" class="footer-menu-wrapper">
<ul class="footer-menu reset-list-style">
</ul>
</nav>
</div>
</div>
</div>
<footer id="site-footer" role="contentinfo" class="header-footer-group">
<div class="section-inner">
<div class="footer-credits">
<p class="footer-copyright">&copy;
2019 <a href="../index.html">Raz</a>
</p>
<p class="powered-by-wordpress">
<a href="https://wordpress.org/">
Powered by WordPress </a>
</p>
</div>
<a class="to-the-top" href="index.html#site-header">
<span class="to-the-top-long">
To the top <span class="arrow" aria-hidden="true">&uarr;</span> </span>
<span class="to-the-top-short">
Up <span class="arrow" aria-hidden="true">&uarr;</span> </span>
</a>
</div>
</footer>
<script src='../wp-content/plugins/jetpack/_inc/build/photon/photon.min.js%3Fver=20191001' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script type="5a8293ed7e8e602563b9c36f-text/javascript">
var countVars = {"disqusShortname":"razvanbangu"};
</script>
<script src='../wp-content/plugins/disqus-comment-system/public/js/comment_count.js%3Fver=3.0.17' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script type="5a8293ed7e8e602563b9c36f-text/javascript">
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.17"},"disqusIdentifier":"333 https:\/\/blog.razb.me\/?p=333","disqusShortname":"razvanbangu","disqusTitle":"Spoofing URL previews","disqusUrl":"https:\/\/blog.razb.me\/spoofing-url-previews\/","postId":"333"};
</script>
<script src='../wp-content/plugins/disqus-comment-system/public/js/comment_embed.js%3Fver=3.0.17' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201948' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script src='../wp-content/plugins/jetpack/_inc/build/spin.min.js%3Fver=1.3' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script src='../wp-content/plugins/jetpack/_inc/build/jquery.spin.min.js%3Fver=1.3' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script type="5a8293ed7e8e602563b9c36f-text/javascript">
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/blog.razb.me\/wp-admin\/admin-ajax.php","nonce":"22c636e423","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/blog.razb.me\/wp-login.php?redirect_to=https%3A%2F%2Fblog.razb.me%2Fspoofing-url-previews%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>"};
</script>
<script src='../wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js%3Fver=20190102' type="5a8293ed7e8e602563b9c36f-text/javascript"></script>
<script type="5a8293ed7e8e602563b9c36f-text/javascript">
			function showhide_toggle(type, post_id, more_text, less_text) {
				var   $link = jQuery("#"+ type + "-link-" + post_id)
					, $link_a = jQuery('a', $link)
					, $content = jQuery("#"+ type + "-content-" + post_id)
					, $toggle = jQuery("#"+ type + "-toggle-" + post_id)
					, show_hide_class = 'sh-show sh-hide';
				$link.toggleClass(show_hide_class);
				$content.toggleClass(show_hide_class).toggle();
				if($link_a.attr('aria-expanded') === 'true') {
					$link_a.attr('aria-expanded', 'false');
				} else {
					$link_a.attr('aria-expanded', 'true');
				}
				if($toggle.text() === more_text) {
					$toggle.text(less_text);
					$link.trigger( "sh-link:more" );
				} else {
					$toggle.text(more_text);
					$link.trigger( "sh-link:less" );
				}
				$link.trigger( "sh-link:toggle" );
			}
		</script>
<div style="display:none">
<div class="grofile-hash-map-aae6720c35ab12fac13db06788b2e7fb">
</div>
</div>
<script type="5a8293ed7e8e602563b9c36f-text/javascript">
	/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
	</script>
<script type="5a8293ed7e8e602563b9c36f-text/javascript" src='https://stats.wp.com/e-201948.js' async='async' defer='defer'></script>
<script type="5a8293ed7e8e602563b9c36f-text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:7.9.1',blog:'108306310',post:'333',tz:'-5',srv:'blog.razb.me'} ]);
	_stq.push([ 'clickTrackerInit', '108306310', '333' ]);
</script>
<script src="https://ajax.cloudflare.com/cdn-cgi/scripts/7089c43e/cloudflare-static/rocket-loader.min.js" data-cf-settings="5a8293ed7e8e602563b9c36f-|49" defer=""></script></body>
</html>
